{% extends 'base.html.twig' %}

{% block title %}Clients{% endblock %}
{% block page_title %}Client Management{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('style/css/CLIENT/client.css') }}">
{% endblock %}

{% block body %}
<!-- Hero Section -->
<section class="hero-section">
    <h1>Client Management Dashboard</h1>
    <p>Manage all clients, track activity, communicate, generate reports, and ensure security from one place.</p>
</section>

<!-- Stats Section -->
<section class="stats-section">
    <h2 class="section-title">Client Overview</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">{{ totalClients }}</div>
            <div class="stat-label">Total Clients</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ activeClients }}</div>
            <div class="stat-label">Active Clients</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ suspendedClients }}</div>
            <div class="stat-label">Inactive Clients</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">â‚±{{ totalRevenue|number_format(2, '.', ',') }}</div>
            <div class="stat-label">Revenue from Clients</div>
        </div>
    </div>
</section>

<!-- Client Table Section -->
<section class="client-table-section">
    <h2 class="section-title">All Clients</h2>
    <table id="clientsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Created At</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for client in clients %}
                <tr>
                    <td>{{ client.id }}</td>
                    <td>{{ client.name }}</td>
                    <td>{{ client.email }}</td>
                    <td>{{ client.phone ?: 'N/A' }}</td>
                    <td>{{ client.createdAt ? client.createdAt|date('Y-m-d H:i') : 'N/A' }}</td>
                    <td>
                        <div style="display: flex; gap: 6px; align-items: center;">
                            <a href="{{ path('app_user_show', {'id': client.id}) }}" class="btn btn-show">Show</a>
                            <a href="{{ path('app_user_edit', {'id': client.id}) }}" class="btn btn-edit">Edit</a>
                        </div>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 40px; color: #9ca3af;">No clients found.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</section>

<!-- Features Section -->
<section class="features-section">
    <h2 class="section-title">Manage Clients</h2>
    <div class="features-grid">
        <div class="feature-card">
            <h3>Manage Data</h3>
            <p>Create, edit, or remove client profiles. Update contact info and status.</p>
            <a href="{{ path('app_user_new') }}" class="btn-primary">Add New Client</a>
        </div>
        <div class="feature-card">
            <h3>Track Activity</h3>
            <p>Monitor client orders, spending, and engagement to identify key clients.</p>
            <a href="#" class="btn-primary">View Activity</a>
        </div>
        <div class="feature-card">
            <h3>Communicate</h3>
            <p>Send emails or notifications directly to clients for updates, promotions, or alerts.</p>
            <a href="#" class="btn-primary">Send Message</a>
        </div>
        <div class="feature-card">
            <h3>Reports & Stats</h3>
            <p>Generate reports, download data, and visualize metrics for better decision-making.</p>
            <a href="#" class="btn-primary">View Reports</a>
        </div>
        <div class="feature-card">
            <h3>Security</h3>
            <p>Suspend accounts, reset passwords, and review audit logs to maintain system security.</p>
            <a href="#" class="btn-primary">Manage Security</a>
        </div>
    </div>
</section>

<!-- Quick Actions -->
<section class="quick-actions">
    <h2 class="section-title">Quick Actions</h2>
    <div class="actions-grid">
        <a href="{{ path('app_user_new') }}" class="action-button">Add Client</a>
        <a href="{{ path('app_user_index') }}" class="action-button">View Clients</a>
        <a href="#" class="action-button">Generate Client Report</a>
        <a href="#" class="action-button">Email All Clients</a>
        <a href="#" class="action-button btn-danger">Delete Client</a>
    </div>
</section>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#clientsTable').DataTable({
                paging: true,
                searching: true,
                ordering: true,
                info: true,
                pageLength: 10,
                lengthMenu: [5, 10, 20, 50],
                order: [[0, 'desc']],
                columnDefs: [
                    { orderable: false, targets: -1 }
                ],
                language: {
                    search: "Search:",
                    lengthMenu: "Show _MENU_ entries",
                    info: "Showing _START_ to _END_ of _TOTAL_ clients",
                    infoEmpty: "Showing 0 to 0 of 0 clients",
                    infoFiltered: "(filtered from _MAX_ total clients)",
                    paginate: {
                        first: "First",
                        last: "Last",
                        next: "Next",
                        previous: "Previous"
                    }
                }
            });
        });
    </script>
{% endblock %}
